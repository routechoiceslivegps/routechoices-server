{% extends "dashboard/home.html" %}
{% load compress django_bootstrap5 static %}
{% block extra_head %}
    {{ block.super }}
    {% compress css %}
        <link rel="stylesheet" href="{% static 'styles/dashboard/club_list.css' %}" />
    {% endcompress %}
{% endblock extra_head %}

{% block sub_content %}
    <div class="row">
        <div class="col-12">
            <h1><i class="fa-solid fa-house-flag"></i> Organisations</h1>
            {% if not clubs %}
                <div class="jumbotron">
                    <p>It seems you don't have an organisation yet! No worries...</p>
                    <p>
                        You can: <a href="{% url 'dashboard_club:create_view' %}" class="btn btn-primary"><i class="fa-solid fa-circle-plus"></i> Create new organisation</a>
                    </p>
                    <p>
                        Or ask to join the list of admins of an existing organisation: <a href="{% url 'dashboard_request_club_invite_view' %}"
    class="btn btn-primary"><i class="fa-solid fa-hand"></i> Request an invite</a>
                    </p>
                </div>
            {% else %}
                <div class="mb-3">
                {% if not request.user.can_create_club %}
                <span class="d-inline-block"
                      tabindex="0"
                      data-bs-toggle="tooltip"
                      data-bs-title="You already have used your quota of free organisations">
                {% endif %}
                <a href="{% url 'dashboard_club:create_view' %}"
                   class="btn btn-primary mb-1 me-1{% if not request.user.can_create_club %} disabled{% endif %}"><i class="fa-solid fa-circle-plus"></i> Create new organisation</a>
                {% if not request.user.can_create_club %}</span>{% endif %}
                <a href="{% url 'dashboard_request_club_invite_view' %}"
                   class="btn btn-primary mb-1"><i class="fa-solid fa-hand"></i> Request an invite</a>
                </div>
                <h3>Select an organisation</h3>
                {% if clubs.paginator.num_pages > 1 %}
                    {% bootstrap_pagination clubs extra=request.GET.urlencode pages_to_show=4 %}
                {% endif %}
                {% for club in clubs %}
                    <div class="card flex-row flex-no-wrap club-card mb-3">
                        <div class="border-0">
                            <img class="card-img-left" style="border-radius: 0.375rem 0 0 0.375rem;" src="{% if club.logo %}{{ club.logo_url }}{% else %}{% static "/img/club-default.png" %}{% endif %}" height="80" width="80" alt="Club {{ club.name }} Logo">
                        </div>
                        <div class="card-body px-2 py-1" style="word-break: break-word">
                            <div class="d-flex flex-row bd-highlight justify-content-between">
                                <div class="p-2 bd-highlight">
                                    <div>
                                        <a class="link-primary-alt stretched-link text-decoration-none fw-bold"
                                           style="font-size: 1.2rem"
                                           href="{% url 'dashboard_club:edit_view' club_slug=club.slug %}?next={{ next }}">{{ club.name }}</a>
                                    </div>
                                    <div>
                                        <small class="text-muted">
                                            {% if club.upgraded %}
                                                Paid Plan{% if club.subscription_paused %} (Paused){% endif %}
                                            {% elif club.o_club %}
                                                Orienteering club (Free usage ends January 1st 2026)
                                            {% else %}
                                                Free Trial{% if not club.free_trial_active %} Expired{% endif %}
                                            {% endif %}
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                {% if clubs.paginator.num_pages > 1 %}
                    {% bootstrap_pagination clubs extra=request.GET.urlencode pages_to_show=4 %}
                {% endif %}
            {% endif %}
        </div>
    </div>
{% endblock sub_content %}
